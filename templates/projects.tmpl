<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>{{ .User }} Projects</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="57x57" href=/static/img/favicon2/apple-icon-57x57.png>
  <link rel="apple-touch-icon" sizes="60x60" href=/static/img/favicon2/img/favicon2/apple-icon-60x60.png>
  <link rel="apple-touch-icon" sizes="72x72" href=/static/img/favicon2/apple-icon-72x72.png>
  <link rel="apple-touch-icon" sizes="76x76" href=/static/img/favicon2/apple-icon-76x76.png>
  <link rel="apple-touch-icon" sizes="114x114" href=/static/img/favicon2/apple-icon-114x114.png>
  <link rel="apple-touch-icon" sizes="120x120" href=/static/img/favicon2/apple-icon-120x120.png>
  <link rel="apple-touch-icon" sizes="144x144" href=/static/img/favicon2/apple-icon-144x144.png>
  <link rel="apple-touch-icon" sizes="152x152" href=/static/img/favicon2/apple-icon-152x152.png>
  <link rel="apple-touch-icon" sizes="180x180" href=/static/img/favicon2/apple-icon-180x180.png>
  <link rel="icon" type="image/png" sizes="192x192" href=/static/img/favicon2/android-icon-192x192.png>
  <link rel="icon" type="image/png" sizes="32x32" href=/static/img/favicon2/favicon-32x32.png>
  <link rel="icon" type="image/png" sizes="96x96" href=/static/img/favicon2/favicon-96x96.png>
  <link rel="icon" type="image/png" sizes="16x16" href=/static/img/favicon2/favicon-16x16.png>
  <link rel="manifest" href=/static/img/favicon2/manifest.json>
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">


  <!--stylesheets / link tags loaded here-->
  <link rel="stylesheet" href="/static/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/static/css/sweetalert.css">
  <style type="text/css">
    /* CSS used here will be applied after bootstrap.css */

    .col-xs-4,
    .col-sm-3,
    .col-md-2 {
      padding: 5px;
    }

    body {
      margin: 0;
      background: #fff;
      max-width: 800px;
      margin: 0 auto;
      background: #fdfdfd;
    }


    @media (min-width: 1200px) {
    .container{
        max-width: 800px;
    }
    }


  </style>


</head>

<body>


    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-bottom">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">{{ .User }} &nbsp;<span id="saveInfo" class="glyphicon" aria-hidden="true"></span></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown active">
              <li><a href="/{{ .User }}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit </a></li>
            <li><a href="/{{ .User }}/view"><span class="glyphicon glyphicon-sunglasses" aria-hidden="true"></span> View</a></li>
            <li><a href="/{{ .User }}/list"><span class="glyphicon glyphicon-align-left" aria-hidden="true"></span> List</a></li>
            <li class="active"><a href="/{{ .User }}/projects"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Projects</a></li>
            <li><a href="/about/view"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> About</a></li>
          </ul>
        </div>
        <!--/.nav-collapse -->
      </div>
    </nav>
  <br>
  <div class="container container-fluid">
    <div class="row"><div class="col-xs-12">
      {{ if .SuccessMessage }}
      <div class="alert alert-success" role="alert">
        <span class="sr-only">Error:</span> {{ .SuccessMessage }}
      </div>
      {{ end }} {{ if .ErrorMessage }}
      <div class="alert alert-danger" role="alert">
        <span class="sr-only">Error:</span> {{ .ErrorMessage }}
      </div>
      {{ end }} {{ if .StatusMessage }}
      <div class="alert alert-info" role="alert">
        <span class="sr-only">Status:</span> {{ .StatusMessage }}
      </div>
      {{ end }}
    </div></div>
    <hr>
    <div class="row">
      <div class="col-xs-6">
        <button class="btn btn-block btn-lg btn-success" id="start">Start</button>
      </div>
      <div class="col-xs-6">
        <button class="btn btn-block btn-lg btn-danger" id="stop">Stop</button>
      </div>
    </div>
    <hr>
    <div class="panel panel-default">
      <div class="panel-heading">
        Projects &nbsp;
        <button class="btn btn-seconday" id="addproject">Add</button>&nbsp;
        <button class="btn btn-seconday" id="deleteproject">Delete</button>
      </div>
      <div class="panel-body">
        <div class="row">
          {{ range .Projects }}
          <div class="col-xs-4 col-sm-3 col-md-2">
            <button class="btn btn-default project" id="{{.}}">{{.}}</button>
          </div>
          {{ end }}
        </div>
      </div>
    </div>
    <hr>
    <div class="panel panel-default">
      <div class="panel-heading">
        Tags &nbsp;
        <button class="btn btn-seconday" id="addtag">Add</button>&nbsp;
        <button class="btn btn-seconday" id="deletetag">Delete</button>
      </div>
      <div class="panel-body">
        <div class="row">
          {{ range .Tags }}
          <div class="col-xs-4 col-sm-3 col-md-2">
            <button class="btn btn-default tag" id="{{.}}">{{.}}</button>
          </div>
          {{ end }}
        </div>
      </div>
    </div>

  </div>
  <form id="startproject" action="/start" method="post">
    <input type="hidden" id="user" name="user" value="{{ .User }}">
    <input type="hidden" id="currentProject" name="currentProject" value="Hello there">
    <input type="hidden" id="tagString" name="tagString" value="Hello there">
  </form>
  <form id="stopproject" action="/stop" method="post">
    <input type="hidden" id="user" name="user" value="{{ .User }}">
  </form>

  <form id="add" action="/add" method="post">
    <input type="hidden" id="user" name="user" value="{{ .User }}">
    <input type="hidden" id="itemType" name="itemType" value="Hello there">
    <input type="hidden" id="itemName" name="itemName" value="Hello there">
  </form>

  <form id="delete" action="/delete" method="post">
    <input type="hidden" id="user" name="user" value="{{ .User }}">
    <input type="hidden" id="itemType" name="itemType" value="Hello there">
    <input type="hidden" id="itemName" name="itemName" value="Hello there">
  </form>

  <!--scripts loaded here-->

  <script src="/static/js/jquery2.min.js"></script>
  <script src="/static/js/bootstrap2.min.js"></script>
  <script src="/static/js/sweetalert-dev.js"></script>



  <script>
    var current_project = "{{ .ProjectString }}";
    var tags = [{{ range .ProjectTags }}'{{.}}',{{end }}''];
    var tag_string = "";

    $(document).ready(function() {

      $('.project').each(function(i, obj) {
        if ($(this).attr('id') == current_project) {
          $(this).toggleClass("btn-primary");
        }
      });
      $('.tag').each(function(i, obj) {
        if ($.inArray($(this).attr('id'), tags) > -1) {
          $(this).toggleClass("btn-info");
        }
      });


      $('button.project').click(function() {
        if ($(this).hasClass("btn-primary") == false) {
          $('.project').each(function(i, obj) {
            $(this).removeClass()
            $(this).addClass("btn btn-default project")
          });
          $(this).toggleClass("btn-primary");
          console.log($(this).attr('id'))
        } else {
          $(this).removeClass()
          $(this).addClass("btn btn-default project")
        }

      });
      $('button.tag').click(function() {
        $(this).toggleClass("btn-info");
        console.log($(this).attr('id'))
      });

      $('button#stop').click(function() {
        console.log("STOPPING")
        $("#currentProject").val(current_project);
        $("#tagString").val(tag_string);
        $("#switchVal").val("stop");
        $("#target").submit();
      });

      $('button#addtag').click(function() {
        swal({
          title: "Enter tags",
          text: "Seperated by commas",
          type: "input",
          showCancelButton: true,
          closeOnConfirm: true,
          animation: "slide-from-top",
          inputPlaceholder: "Write something"
        }, function(inputValue) {
          if (inputValue === false) return false;
          if (inputValue === "") return false
          $("input#itemType").val("tags");
          $("input#itemName").val(inputValue);
          $("form#add").submit();
          return true
        });
      });


      $('button#addproject').click(function() {
        swal({
          title: "Enter new project name",
          text: "E.g. digging a tunnel",
          type: "input",
          showCancelButton: true,
          closeOnConfirm: true,
          animation: "slide-from-top",
          inputPlaceholder: "Write something"
        }, function(inputValue) {
          if (inputValue === false) return false;
          if (inputValue === "") return false
          $("input#itemType").val("projects");
          $("input#itemName").val(inputValue);
          $("form#add").submit();
          return true
        });
      });

      $('button#deleteproject').click(function() {
        current_project = ""
        $('.project.btn-primary').each(function(i, obj) {
          current_project = $(this).attr('id');
        });
        if (current_project != "") {
          $("input#itemType").val("projects");
          $("input#itemName").val(current_project);
          $("form#delete").submit();
        }
      });


      $('button#deletetag').click(function() {
        current_project = ""
        $('.tag.btn-info').each(function(i, obj) {
          current_project = $(this).attr('id');
        });
        if (current_project != "") {
          $("input#itemType").val("tags");
          $("input#itemName").val(current_project);
          $("form#delete").submit();
        }
      });




      $('button#start').click(function() {
        current_project = ""
        $('.project.btn-primary').each(function(i, obj) {
          current_project = $(this).attr('id');
        });
        tag_array = []
        $('.tag.btn-info').each(function(i, obj) {
          tag_array.push($(this).attr('id'));
        });
        tag_string = tag_array.join()
        if (current_project != "") {
          $("#currentProject").val(current_project);
          $("#tagString").val(tag_string);
          $("form#startproject").submit();
        } else {
          sweetAlert("Oops...", "You need to set a project!", "error");
        }
      });

      $('button#stop').click(function() {
        $("form#stopproject").submit();
      });

    });
  </script>

</body>

</html>
